<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carrinho de Compras</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #000;
            color: #fff;
            margin: 0;
            padding: 0;
        }
        #logo {
            display: block;
            width: 80px;
            margin: 20px auto;
        }
        .cart-page {
            padding: 20px;
        }
        .cart-item {
            display: flex;
            justify-content: space-between;
            padding: 10px;
            background-color: #1c1c1c;
            margin-bottom: 10px;
            border-radius: 5px;
        }
        .cart-item p {
            margin: 0;
        }
        .total-price {
            background-color: #1c1c1c;
            padding: 15px;
            margin-top: 20px;
            font-size: 18px;
            display: flex;
            justify-content: space-between;
            border-radius: 5px;
        }
        .checkout {
            background-color: #4CAF50;
            color: white;
            padding: 10px;
            width: 100%;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 20px;
        }
        .payment-methods {
            background-color: #1c1c1c;
            padding: 20px;
            margin-top: 20px;
            border-radius: 5px;
        }
        .payment-method {
            background-color: #333;
            border: 1px solid #444;
            padding: 10px;
            border-radius: 4px;
            margin: 5px;
            cursor: pointer;
        }
        .payment-method.selected {
            background-color: #4CAF50;
            color: white;
        }
        .form-field {
            margin-bottom: 10px;
        }
        .form-field input {
            padding: 10px;
            width: 100%;
            border: 1px solid #444;
            border-radius: 5px;
            background-color: #333;
            color: white;
        }
    </style>
</head>
<body>
    <h1>Carrinho de Compras</h1>
    <img src="logo.png" alt="Logo" id="logo">

    <!-- Página do Carrinho -->
    <div class="cart-page">
        <div id="cart-items">
            <!-- Itens do carrinho serão exibidos aqui -->
        </div>

        <div class="total-price">
            <p>Total:</p>
            <p id="total-price">R$ 0,00</p>
        </div>

        <!-- Formulário de Pagamento -->
        <div class="payment-methods">
            <h2>Escolha a forma de pagamento:</h2>
            <div class="payment-method" data-method="pix">Pix</div>
            <div class="payment-method" data-method="money">Dinheiro</div>
            <div class="payment-method" data-method="card">Cartão Débito/Crédito</div>
            <p id="payment-note" style="color: #bbb; text-align: center; margin-top: 10px;">Taxa de entrega: 10 reais para dinheiro ou cartão. Pix sem taxa.</p>
        </div>

        <div id="troco-field" style="display:none;">
            <label for="troco">Precisa de troco? (em Reais):</label>
            <input type="number" id="troco" name="troco" placeholder="Valor do troco">
        </div>

        <div class="delivery-info">
            <h2>Informações de Entrega</h2>
            <div class="form-field">
                <label for="name">Nome:</label>
                <input type="text" id="name" placeholder="Digite seu nome">
            </div>
            <div class="form-field">
                <label for="address">Endereço:</label>
                <input type="text" id="address" placeholder="Digite seu endereço">
            </div>
            <div class="form-field">
                <label for="phone">Número:</label>
                <input type="text" id="phone" placeholder="Digite seu número">
            </div>
        </div>

        <button class="checkout" id="checkout-btn">Finalizar Compra</button>
    </div>

    <script>
        // Função para carregar os itens do carrinho e calcular o total
        function loadCart() {
            let cart = JSON.parse(localStorage.getItem('cart')) || []; // Carrega o carrinho do localStorage
            let cartItemsContainer = document.getElementById('cart-items');
            let totalPrice = 0;
            let itemCount = 0;

            // Limpar itens existentes no carrinho
            cartItemsContainer.innerHTML = '';

            // Verifica se o carrinho está vazio
            if (cart.length === 0) {
                document.getElementById('total-price').textContent = 'R$ 0,00'; // Total vazio
                document.getElementById('item-count').textContent = '0'; // Contador vazio
            }

            // Exibe os itens no carrinho
            cart.forEach(item => {
                // Criar cada item no carrinho
                let itemElement = document.createElement('div');
                itemElement.classList.add('cart-item');
                itemElement.innerHTML = `
                    <p>${item.name}</p>
                    <p>R$ ${item.price.toFixed(2)}</p>
                `;
                cartItemsContainer.appendChild(itemElement);

                // Somar preço total e contador de itens
                totalPrice += item.price;
                itemCount += 1; // Contabilizando o item
            });

            // Atualizar o preço total e o contador de itens
            document.getElementById('total-price').textContent = `R$ ${totalPrice.toFixed(2)}`;
            document.getElementById('item-count').textContent = itemCount; // Atualiza o contador
        }

        // Função para adicionar um item ao carrinho
        function addToCart(item) {
            let cart = JSON.parse(localStorage.getItem('cart')) || [];

            // Verifica se o item já existe no carrinho
            let existingItem = cart.find(cartItem => cartItem.name === item.name);
            if (existingItem) {
                existingItem.quantity += 1; // Se já existir, aumenta a quantidade
            } else {
                cart.push(item); // Caso contrário, adiciona o item com quantidade 1
            }

            // Atualiza o carrinho no localStorage
            localStorage.setItem('cart', JSON.stringify(cart));
            loadCart(); // Atualiza a exibição do carrinho
        }

        // Função para lidar com a escolha de forma de pagamento
        document.querySelectorAll('.payment-method').forEach(method => {
            method.addEventListener('click', function() {
                document.querySelectorAll('.payment-method').forEach(m => m.classList.remove('selected'));
                method.classList.add('selected');
            });
        });

        // Função para finalizar compra
        document.getElementById('checkout-btn').addEventListener('click', function() {
            let cart = JSON.parse(localStorage.getItem('cart')) || [];
            let selectedPayment = document.querySelector('.payment-method.selected');
            let name = document.getElementById('name').value;
            let address = document.getElementById('address').value;
            let phone = document.getElementById('phone').value;

            if (cart.length === 0) {
                alert('Seu carrinho está vazio!');
                return;
            }

            if (!selectedPayment) {
                alert('Por favor, selecione uma forma de pagamento!');
                return;
            }

            if (!name || !address || !phone) {
                alert('Por favor, preencha todos os campos de entrega!');
                return;
            }

            // Calcular taxa de entrega
            let deliveryFee = 0;
            if (selectedPayment.dataset.method === 'money' || selectedPayment.dataset.method === 'card') {
                deliveryFee = 10;
            }

            let totalPrice = cart.reduce((total, item) => total + item.price, 0) + deliveryFee;

            alert(`Compra finalizada!\nTotal: R$ ${totalPrice.toFixed(2)}\nForma de pagamento: ${selectedPayment.textContent}`);
            localStorage.removeItem('cart'); // Limpar o carrinho após a finalização
            loadCart(); // Atualizar a página
        });

        // Carregar o carrinho quando a página for carregada
        loadCart();
    </script>
</body>
</html>
